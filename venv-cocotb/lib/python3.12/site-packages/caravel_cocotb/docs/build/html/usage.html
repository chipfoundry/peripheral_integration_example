<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quickstart Guide &mdash; caravel_cocotb alpha documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Python APIs" href="python_api.html" />
    <link rel="prev" title="Welcome to caravel_cocotb’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            caravel_cocotb
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quickstart Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#caravel-cocotb">caravel_cocotb</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-to-install-caravel-cocotb">How to install caravel_cocotb</a></li>
<li class="toctree-l3"><a class="reference internal" href="#caravel-cocotb-usage">caravel_cocotb usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-test">Creating a Test</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-a-test">Adding a test</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#python-template">Python Template</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#c-template">C Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="#test-examples">Test Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#running-a-test">Running a Test</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#run-test-tests">Run test/tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-testlist">Creating a Testlist</a></li>
<li class="toctree-l2"><a class="reference internal" href="#results">Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="#update-design-info-yaml">Update design_info.yaml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="python_api.html">Python APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="C_api.html">Firmware APIs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">caravel_cocotb</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Quickstart Guide</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/usage.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="quickstart-guide">
<span id="usage"></span><h1>Quickstart Guide<a class="headerlink" href="#quickstart-guide" title="Permalink to this heading"></a></h1>
<p>This project aims to provide a user friendly environment for adding and running cocotb tests for Caravel user projects.</p>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading"></a></h2>
<!-- start configure the repo include0 --><ul class="simple">
<li><p>Docker: <a class="reference external" href="https://hub.docker.com/search?q=&amp;type=edition&amp;offering=community&amp;operating_system=linux&amp;utm_source=docker&amp;utm_medium=webreferral&amp;utm_campaign=dd-smartbutton&amp;utm_location=header">Linux</a> ||  <a class="reference external" href="https://desktop.docker.com/win/main/amd64/Docker%20Desktop%20Installer.exe?utm_source=docker&amp;utm_medium=webreferral&amp;utm_campaign=dd-smartbutton&amp;utm_location=header">Windows</a> || <a class="reference external" href="https://desktop.docker.com/mac/main/amd64/Docker.dmg?utm_source=docker&amp;utm_medium=webreferral&amp;utm_campaign=dd-smartbutton&amp;utm_location=header">Mac with Intel Chip</a> || <a class="reference external" href="https://desktop.docker.com/mac/main/arm64/Docker.dmg?utm_source=docker&amp;utm_medium=webreferral&amp;utm_campaign=dd-smartbutton&amp;utm_location=header">Mac with M1 Chip</a></p></li>
<li><p>Python 3.6+ with PIP</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">docker</span> <span class="pre">pull</span> <span class="pre">efabless/dv:cocotb</span></code></p></li>
<li><p>Clone of Caravel</p></li>
<li><p>Clone of Caravel management repo</p></li>
<li><p>Clone of PDK from <a class="reference external" href="https://github.com/efabless/volare">volare</a></p></li>
<li><p>Clone of Caravel user project</p></li>
</ul>
<!-- end configure the repo include0 --></section>
<section id="caravel-cocotb">
<h2>caravel_cocotb<a class="headerlink" href="#caravel-cocotb" title="Permalink to this heading"></a></h2>
<section id="how-to-install-caravel-cocotb">
<h3>How to install caravel_cocotb<a class="headerlink" href="#how-to-install-caravel-cocotb" title="Permalink to this heading"></a></h3>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">pip</span> <span class="n">install</span> <span class="n">caravel</span><span class="o">-</span><span class="n">cocotb</span>
</pre></div>
</div>
<p>or to install from repo</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="nd">@github</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">efabless</span><span class="o">/</span><span class="n">caravel</span><span class="o">-</span><span class="n">sim</span><span class="o">-</span><span class="n">infrastructure</span><span class="o">.</span><span class="n">git</span>
   <span class="n">git</span> <span class="n">checkout</span> <span class="o">&lt;</span><span class="n">release</span><span class="o">&gt;</span>
   <span class="n">cd</span> <span class="n">caravel</span><span class="o">-</span><span class="n">sim</span><span class="o">-</span><span class="n">infrastructure</span><span class="o">/</span><span class="n">cocotb</span>
   <span class="n">pip</span> <span class="n">install</span> <span class="o">.</span>
   <span class="n">cd</span> <span class="o">../..</span>
</pre></div>
</div>
</section>
<section id="caravel-cocotb-usage">
<h3>caravel_cocotb usage<a class="headerlink" href="#caravel-cocotb-usage" title="Permalink to this heading"></a></h3>
<p>caravel_cocotb provides a flow and APIs to run simulation on user_project after integerated with caravel. This is so helpful in detecting any bug in the connection between the user project and Caravel IOs, wishbone interface or logic analyzers. Also since it’s easy to add and run tests with this flow it can be used to test the whole user project.</p>
</section>
</section>
<section id="creating-a-test">
<span id="create-test"></span><h2>Creating a Test<a class="headerlink" href="#creating-a-test" title="Permalink to this heading"></a></h2>
<section id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>install <a class="reference external" href="#how-to-install-caravel_cocotb">cocotb_caravel</a></p></li>
<li><p>update netlist for RTL and GL files at <code class="code docutils literal notranslate"><span class="pre">&lt;caravel_user_project&gt;/verilog/includes/</span></code> with the design netlist</p></li>
<li><p>update the <a class="reference external" href="#update-design_infoyaml">design_info</a> file at <code class="code docutils literal notranslate"><span class="pre">&lt;caravel_user_project&gt;/verilog/dv/cocotb/design_info.yaml</span></code></p></li>
</ul>
</section>
<section id="adding-a-test">
<h3>Adding a test<a class="headerlink" href="#adding-a-test" title="Permalink to this heading"></a></h3>
<p>This section explains the steps needed to create a test.</p>
<p>A typical test for <em>Caravel</em> consists of 2 parts: <code class="code docutils literal notranslate"><span class="pre">Python/cocotb</span></code> code and <code class="code docutils literal notranslate"><span class="pre">C</span></code> code.</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">Python/cocotb</span></code> code is for communicating with <em>Caravel</em> hardware interface inputs, outputs, clock, reset, and power ports/bins. <code class="code docutils literal notranslate"><span class="pre">cocotb</span></code> here replaces the <code class="code docutils literal notranslate"><span class="pre">verilog</span></code> code.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">C</span></code> code provides firmware code that would be loaded into the <em>Caravel</em> CPU.</p></li>
</ul>
<p>Tests files has to located under <code class="code docutils literal notranslate"><span class="pre">&lt;caravel_user_project&gt;/verilog/dv/cocotb/</span></code></p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span>| dv
| ├── cocotb
| │   ├── &lt;new_test&gt;
| │   │   └── &lt;new_test.py&gt;
| │   │   └── &lt;new_test.c&gt;
| │   └── cocotb_tests.py
| │   └── design_info.yaml
|
</pre></div>
</div>
<blockquote>
<div><p><strong>Note</strong>: The name of <code class="code docutils literal notranslate"><span class="pre">C</span></code> file must match the name of <code class="code docutils literal notranslate"><span class="pre">cocotb</span></code> test function</p>
</div></blockquote>
<section id="python-template">
<h4>Python Template<a class="headerlink" href="#python-template" title="Permalink to this heading"></a></h4>
<p>The template for <code class="code docutils literal notranslate"><span class="pre">python</span></code> test:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span>
   <span class="kn">from</span> <span class="nn">caravel_cocotb.caravel_interfaces</span> <span class="kn">import</span> <span class="n">test_configure</span>
   <span class="kn">from</span> <span class="nn">caravel_cocotb.caravel_interfaces</span> <span class="kn">import</span> <span class="n">report_test</span>
   <span class="kn">from</span> <span class="nn">caravel_cocotb.caravel_interfaces</span> <span class="kn">import</span> <span class="n">UART</span>
   <span class="kn">from</span> <span class="nn">caravel_cocotb.caravel_interfaces</span> <span class="kn">import</span> <span class="n">SPI</span>
   <span class="kn">import</span> <span class="nn">cocotb</span>

   <span class="nd">@cocotb</span><span class="o">.</span><span class="n">test</span><span class="p">()</span> <span class="c1"># decorator to mark the test function as cocotb test</span>
   <span class="nd">@report_test</span> <span class="c1"># wrapper for configure test reporting files</span>
   <span class="k">async</span> <span class="k">def</span> <span class="o">&lt;</span><span class="n">test_name</span><span class="o">&gt;</span><span class="p">(</span><span class="n">dut</span><span class="p">):</span>
      <span class="n">caravelEnv</span> <span class="o">=</span> <span class="k">await</span> <span class="n">test_configure</span><span class="p">(</span><span class="n">dut</span><span class="p">)</span> <span class="c1">#configure, start up and reset Caravel</span>

      <span class="c1">######################## add test sequence ######################</span>
</pre></div>
</div>
</section>
</section>
<p>Commonly used APIs to monitor or drive the hardware can be found in in <a class="reference internal" href="python_api.html"><span class="doc">Python APIs</span></a></p>
<blockquote>
<div><p>! <strong>Warning:</strong> New test python function should be imported into cocotb_tests.py</p>
</div></blockquote>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="kn">from</span> <span class="o">&lt;</span><span class="n">new_test</span><span class="o">&gt;.&lt;</span><span class="n">new_test</span><span class="o">&gt;</span> <span class="kn">import</span> <span class="o">&lt;</span><span class="n">new_test</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="c-template">
<h3>C Template<a class="headerlink" href="#c-template" title="Permalink to this heading"></a></h3>
<p>The template for Code test:</p>
<div class="code C++ highlight-default notranslate"><div class="highlight"><pre><span></span>
   <span class="c1">#include &lt;firmware_apis.h&gt; // include required APIs</span>
   <span class="n">void</span> <span class="n">main</span><span class="p">(){</span>
      <span class="o">//////////////////////</span><span class="n">add</span> <span class="n">test</span> <span class="n">here</span><span class="o">//////////////////////</span>
      <span class="k">return</span><span class="p">;</span>
   <span class="p">}</span>
</pre></div>
</div>
</section>
<p>Commonly used APIs for firmware can be found in <a class="reference internal" href="C_api.html"><span class="doc">Firmware APIs</span></a></p>
<section id="test-examples">
<h3>Test Examples<a class="headerlink" href="#test-examples" title="Permalink to this heading"></a></h3>
<p>Refer to this <a class="reference external" href="https://github.com/efabless/caravel_user_project/tree/main/verilog/dv/cocotb">directory</a> for tests example generated for 16-bit counter</p>
</section>
</section>
<section id="running-a-test">
<span id="run-test"></span><h2>Running a Test<a class="headerlink" href="#running-a-test" title="Permalink to this heading"></a></h2>
<section id="run-test-tests">
<h3>Run test/tests<a class="headerlink" href="#run-test-tests" title="Permalink to this heading"></a></h3>
<p>Tests can run individually or as a test group using <code class="code docutils literal notranslate"><span class="pre">testlist</span></code>. Tests can also run in RTL, GL or SDF sims with 9 different corners.</p>
<p>To run use caravel_cocotb in the location that has the design_info.yaml file or pass the path to the design_info.yaml file as a command -design_info:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">caravel_cocotb</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">test</span> <span class="n">TEST</span> <span class="p">[</span><span class="n">TEST</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">-</span><span class="n">design_info</span> <span class="n">DESIGN_INFO</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">-</span><span class="n">sim</span> <span class="n">SIM</span> <span class="p">[</span><span class="n">SIM</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">-</span><span class="n">testlist</span> <span class="n">TESTLIST</span> <span class="p">[</span><span class="n">TESTLIST</span> <span class="o">...</span><span class="p">]]</span>
                      <span class="p">[</span><span class="o">-</span><span class="n">tag</span> <span class="n">TAG</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">maxerr</span> <span class="n">MAXERR</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">vcs</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">-</span><span class="n">corner</span> <span class="n">CORNER</span> <span class="p">[</span><span class="n">CORNER</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">-</span><span class="n">zip_passed</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">-</span><span class="n">emailto</span> <span class="n">EMAILTO</span> <span class="p">[</span><span class="n">EMAILTO</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">-</span><span class="n">seed</span> <span class="n">SEED</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">no_wave</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">-</span><span class="n">sdf_setup</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">clk</span> <span class="n">CLK</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">lint</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">-</span><span class="n">macros</span> <span class="n">MACROS</span> <span class="p">[</span><span class="n">MACROS</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">-</span><span class="n">sim_path</span> <span class="n">SIM_PATH</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">-</span><span class="n">verbosity</span> <span class="n">VERBOSITY</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">openframe</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">check_commits</span><span class="p">]</span>
                      <span class="p">[</span><span class="o">-</span><span class="n">no_docker</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="nb">compile</span><span class="p">]</span>

<span class="n">Run</span> <span class="n">cocotb</span> <span class="n">tests</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">-</span><span class="n">test</span> <span class="n">TEST</span> <span class="p">[</span><span class="n">TEST</span> <span class="o">...</span><span class="p">],</span> <span class="o">-</span><span class="n">t</span> <span class="n">TEST</span> <span class="p">[</span><span class="n">TEST</span> <span class="o">...</span><span class="p">]</span>
                        <span class="n">name</span> <span class="n">of</span> <span class="n">test</span> <span class="ow">or</span> <span class="n">tests</span><span class="o">.</span><span class="k">if</span> <span class="n">no</span> <span class="o">--</span><span class="n">sim</span> <span class="n">provided</span> <span class="n">RTL</span> <span class="n">will</span> <span class="n">be</span>
                        <span class="n">run</span> <span class="o">&lt;</span><span class="n">takes</span> <span class="nb">list</span> <span class="k">as</span> <span class="nb">input</span><span class="o">&gt;</span>
  <span class="o">-</span><span class="n">design_info</span> <span class="n">DESIGN_INFO</span><span class="p">,</span> <span class="o">-</span><span class="n">di</span> <span class="n">DESIGN_INFO</span>
                        <span class="n">path</span> <span class="n">to</span> <span class="n">design_info</span><span class="o">.</span><span class="n">yaml</span> <span class="n">file</span>
  <span class="o">-</span><span class="n">sim</span> <span class="n">SIM</span> <span class="p">[</span><span class="n">SIM</span> <span class="o">...</span><span class="p">]</span>    <span class="n">Simulation</span> <span class="nb">type</span> <span class="n">RTL</span><span class="p">,</span><span class="n">GL</span> <span class="o">&amp;</span> <span class="n">GL_SDF</span> <span class="n">provided</span> <span class="n">only</span> <span class="n">when</span> <span class="n">run</span>
                        <span class="o">-</span><span class="n">test</span><span class="o">&lt;</span><span class="n">takes</span> <span class="nb">list</span> <span class="k">as</span> <span class="nb">input</span><span class="o">&gt;</span>
  <span class="o">-</span><span class="n">testlist</span> <span class="n">TESTLIST</span> <span class="p">[</span><span class="n">TESTLIST</span> <span class="o">...</span><span class="p">],</span> <span class="o">-</span><span class="n">tl</span> <span class="n">TESTLIST</span> <span class="p">[</span><span class="n">TESTLIST</span> <span class="o">...</span><span class="p">]</span>
                        <span class="n">path</span> <span class="n">of</span> <span class="n">testlist</span> <span class="n">to</span> <span class="n">be</span> <span class="n">run</span>
  <span class="o">-</span><span class="n">tag</span> <span class="n">TAG</span>              <span class="n">provide</span> <span class="n">tag</span> <span class="n">of</span> <span class="n">the</span> <span class="n">run</span> <span class="n">default</span> <span class="n">would</span> <span class="n">be</span> <span class="n">regression</span>
                        <span class="n">name</span> <span class="ow">and</span> <span class="k">if</span> <span class="n">no</span> <span class="n">regression</span> <span class="ow">is</span> <span class="n">provided</span> <span class="n">would</span> <span class="n">be</span>
                        <span class="n">run_</span><span class="o">&lt;</span><span class="n">random</span> <span class="nb">float</span><span class="o">&gt;</span><span class="n">_</span><span class="o">&lt;</span><span class="n">timestamp</span><span class="o">&gt;</span><span class="n">_</span>
  <span class="o">-</span><span class="n">maxerr</span> <span class="n">MAXERR</span>        <span class="nb">max</span> <span class="n">number</span> <span class="n">of</span> <span class="n">errors</span> <span class="k">for</span> <span class="n">every</span> <span class="n">test</span> <span class="n">before</span> <span class="n">simulation</span>
                        <span class="n">breaks</span> <span class="n">default</span> <span class="o">=</span> <span class="mi">3</span>
  <span class="o">-</span><span class="n">vcs</span><span class="p">,</span> <span class="o">-</span><span class="n">v</span>              <span class="n">use</span> <span class="n">VCS</span> <span class="k">as</span> <span class="n">compiler</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">used</span> <span class="n">iverilog</span> <span class="n">would</span> <span class="n">be</span> <span class="n">used</span>
  <span class="o">-</span><span class="n">corner</span> <span class="n">CORNER</span> <span class="p">[</span><span class="n">CORNER</span> <span class="o">...</span><span class="p">],</span> <span class="o">-</span><span class="n">c</span> <span class="n">CORNER</span> <span class="p">[</span><span class="n">CORNER</span> <span class="o">...</span><span class="p">]</span>
                        <span class="n">Corner</span> <span class="nb">type</span> <span class="ow">in</span> <span class="n">case</span> <span class="n">of</span> <span class="n">GL_SDF</span> <span class="n">run</span> <span class="n">has</span> <span class="n">to</span> <span class="n">be</span> <span class="n">provided</span>
  <span class="o">-</span><span class="n">zip_passed</span>           <span class="nb">zip</span> <span class="n">the</span> <span class="n">waves</span> <span class="ow">and</span> <span class="n">logs</span> <span class="n">of</span> <span class="n">passed</span> <span class="n">tests</span><span class="o">.</span> <span class="n">by</span> <span class="n">default</span> <span class="k">if</span>
                        <span class="n">the</span> <span class="n">run</span> <span class="n">has</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">7</span> <span class="n">tests</span> <span class="k">pass</span> <span class="n">tests</span> <span class="n">results</span> <span class="n">would</span>
                        <span class="n">be</span> <span class="n">zipped</span> <span class="n">automatically</span>
  <span class="o">-</span><span class="n">emailto</span> <span class="n">EMAILTO</span> <span class="p">[</span><span class="n">EMAILTO</span> <span class="o">...</span><span class="p">],</span> <span class="o">-</span><span class="n">mail</span> <span class="n">EMAILTO</span> <span class="p">[</span><span class="n">EMAILTO</span> <span class="o">...</span><span class="p">]</span>
                        <span class="n">mails</span> <span class="n">to</span> <span class="n">send</span> <span class="n">results</span> <span class="n">to</span> <span class="n">when</span> <span class="n">results</span> <span class="n">finish</span>
  <span class="o">-</span><span class="n">seed</span> <span class="n">SEED</span>            <span class="n">run</span> <span class="k">with</span> <span class="n">specific</span> <span class="n">seed</span>
  <span class="o">-</span><span class="n">no_wave</span>              <span class="n">disable</span> <span class="n">dumping</span> <span class="n">waves</span>
  <span class="o">-</span><span class="n">sdf_setup</span>            <span class="n">targeting</span> <span class="n">setup</span> <span class="n">violations</span> <span class="n">by</span> <span class="n">taking</span> <span class="n">the</span> <span class="n">SDF</span> <span class="n">maximum</span>
                        <span class="n">values</span>
  <span class="o">-</span><span class="n">clk</span> <span class="n">CLK</span>              <span class="n">define</span> <span class="n">the</span> <span class="n">clock</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">ns</span> <span class="n">default</span> <span class="n">defined</span> <span class="n">at</span>
                        <span class="n">design_info</span><span class="o">.</span><span class="n">yaml</span>
  <span class="o">-</span><span class="n">lint</span>                 <span class="n">generate</span> <span class="n">lint</span> <span class="n">log</span> <span class="n">VCS</span> <span class="n">must</span> <span class="n">be</span> <span class="n">used</span>
  <span class="o">-</span><span class="n">macros</span> <span class="n">MACROS</span> <span class="p">[</span><span class="n">MACROS</span> <span class="o">...</span><span class="p">]</span>
                        <span class="n">Add</span> <span class="n">additional</span> <span class="n">verilog</span> <span class="n">macros</span> <span class="k">for</span> <span class="n">the</span> <span class="n">design</span>
  <span class="o">-</span><span class="n">sim_path</span> <span class="n">SIM_PATH</span>    <span class="n">directory</span> <span class="n">where</span> <span class="n">simulation</span> <span class="n">result</span> <span class="n">directory</span> <span class="s2">&quot;sim&quot;</span>
                        <span class="n">would</span> <span class="n">be</span> <span class="n">created</span> <span class="k">if</span> <span class="kc">None</span> <span class="n">it</span> <span class="n">would</span> <span class="n">be</span> <span class="n">created</span> <span class="n">under</span>
                        <span class="n">cocotb</span> <span class="n">folder</span>
  <span class="o">-</span><span class="n">verbosity</span> <span class="n">VERBOSITY</span>  <span class="n">verbosity</span> <span class="n">of</span> <span class="n">the</span> <span class="n">console</span> <span class="n">output</span> <span class="n">it</span> <span class="n">can</span> <span class="n">have</span> <span class="n">one</span> <span class="n">of</span> <span class="mi">3</span>
                        <span class="n">value</span> <span class="n">debug</span><span class="p">,</span> <span class="n">normal</span> <span class="ow">or</span> <span class="n">quiet</span> <span class="n">the</span> <span class="n">default</span> <span class="n">value</span> <span class="ow">is</span>
                        <span class="n">normal</span>
  <span class="o">-</span><span class="n">openframe</span>            <span class="n">use</span> <span class="n">openframe</span> <span class="k">for</span> <span class="n">the</span> <span class="n">simulation</span> <span class="n">rather</span> <span class="n">than</span> <span class="n">caravel</span>
  <span class="o">-</span><span class="n">check_commits</span>        <span class="n">use</span> <span class="n">to</span> <span class="n">check</span> <span class="k">if</span> <span class="n">repos</span> <span class="n">are</span> <span class="n">up</span> <span class="n">to</span> <span class="n">date</span>
  <span class="o">-</span><span class="n">no_docker</span>            <span class="n">run</span> <span class="n">iverilog</span> <span class="n">without</span> <span class="n">docker</span>
  <span class="o">-</span><span class="nb">compile</span>              <span class="n">force</span> <span class="n">recompilation</span>
</pre></div>
</div>
<section id="example">
<h4>Example<a class="headerlink" href="#example" title="Permalink to this heading"></a></h4>
<section id="run-one-test-in-rtl">
<h5>Run one test in RTL<a class="headerlink" href="#run-one-test-in-rtl" title="Permalink to this heading"></a></h5>
<p><code class="code docutils literal notranslate"><span class="pre">caravel_cocotb</span> <span class="pre">-t</span> <span class="pre">&lt;testname&gt;</span> <span class="pre">-tag</span> <span class="pre">run_one_test</span></code></p>
</section>
<section id="run-2-tests-in-gl">
<h5>Run 2 tests in GL<a class="headerlink" href="#run-2-tests-in-gl" title="Permalink to this heading"></a></h5>
<p><code class="code docutils literal notranslate"><span class="pre">caravel_cocotb</span> <span class="pre">-t</span> <span class="pre">&lt;test1&gt;</span> <span class="pre">&lt;test2&gt;</span>&#160; <span class="pre">-sim</span> <span class="pre">GL</span></code></p>
</section>
<section id="run-testlist">
<h5>Run testlist<a class="headerlink" href="#run-testlist" title="Permalink to this heading"></a></h5>
<p><code class="code docutils literal notranslate"><span class="pre">caravel_cocotb</span> <span class="pre">-tl</span> <span class="pre">&lt;path</span> <span class="pre">to</span> <span class="pre">testlist&gt;</span> <span class="pre">-tag</span> <span class="pre">all_rtl</span></code></p>
</section>
</section>
</section>
</section>
<section id="creating-a-testlist">
<span id="create-testlist"></span><h2>Creating a Testlist<a class="headerlink" href="#creating-a-testlist" title="Permalink to this heading"></a></h2>
<p>Testlist is a file that contains a collection of test names to run together.</p>
<p>The syntax is simple as <code class="code docutils literal notranslate"><span class="pre">YAML</span></code> is used to write the testlist</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span>
   <span class="c1"># Testlist Can has only 2 elements Tests or includes</span>

   <span class="c1"># Test element has list of dictionaries of tests to include</span>
   <span class="n">Tests</span><span class="p">:</span>
      <span class="o">-</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">test1</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">sim</span><span class="p">:</span> <span class="n">RTL</span><span class="p">}</span>
      <span class="o">-</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">test1</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">sim</span><span class="p">:</span> <span class="n">GL</span><span class="p">}</span>
      <span class="o">-</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">test2</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">sim</span><span class="p">:</span> <span class="n">RTL</span><span class="p">}</span>

   <span class="c1"># include has paths  for other testlist to include in this test list</span>
   <span class="c1"># paths are relative to the location of this yaml file</span>
   <span class="n">includes</span><span class="p">:</span>
      <span class="o">-</span> <span class="o">&lt;</span><span class="n">test4</span><span class="o">&gt;/&lt;</span><span class="n">testlist</span><span class="o">&gt;.</span><span class="n">yaml</span>
      <span class="o">-</span> <span class="o">&lt;</span><span class="n">testlist</span><span class="o">&gt;.</span><span class="n">yaml</span>
      <span class="o">-</span> <span class="o">../&lt;</span><span class="n">test5</span><span class="o">&gt;/&lt;</span><span class="n">testlist</span><span class="o">&gt;.</span><span class="n">yaml</span>
</pre></div>
</div>
</section>
<section id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this heading"></a></h2>
<p>New directory named <code class="code docutils literal notranslate"><span class="pre">sim</span></code> would be created under <code class="code docutils literal notranslate"><span class="pre">&lt;repo</span> <span class="pre">root&gt;/cocotb/</span></code> or to the path passed to <code class="code docutils literal notranslate"><span class="pre">-sim_path</span></code> and it will have all the results.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span>
| sim #  directory get generate when run a test
│ ├── &lt;tag&gt; # tag of the run
│ │   ├── compilation # directory contain all logs and build files related to the RTL compilation
│ │   │   └── compilation.log  # log file has all the commands used to run iverilog and any compilation error or warning
│ │   ├── &lt;sim type&gt;-&lt;test name&gt; # test result directory contain all logs and wave related to the test
│ │   │   └── firmware.hex  # hex file used in running this test
│ │   │   └── &lt;test name&gt;.log  # log file generated from cocotb
│ │   │   └── firmware.log     # log file has all the commands used to compile the C code and any compilation error or warning
│ │   │   └── waves.vcd  # waves can be opened by gtkwave
│ │   │   └── rerun.py         # script to rerun the test
│ │   └── command.log    # command use for this run
│ │   └── repos_info.log # contain information about the repos used to run these tests
│ │   └── configs.yaml   # contain information about the repos used to run these tests
│ │   └── runs.log       # contains status of the run fails and passes tests
│ ├── hex_files # directory contain all the generated hex files for the runs
│
│
</pre></div>
</div>
</section>
<section id="update-design-info-yaml">
<h2>Update design_info.yaml<a class="headerlink" href="#update-design-info-yaml" title="Permalink to this heading"></a></h2>
<p><code class="code docutils literal notranslate"><span class="pre">design_info.yaml</span></code> are used to reference all the needed repos and paths needed to run the tests:</p>
<p>fill  it like the following</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="c1">#yaml file contain general design information that would mostly need to be updated in the first run only</span>
  <span class="c1">#eg CARAVEL_ROOT: &quot;/usr/Desktop/caravel_project/caravel/&quot;</span>
  <span class="c1">#like repo https://github.com/efabless/caravel</span>
  <span class="n">CARAVEL_ROOT</span><span class="p">:</span> <span class="s2">&quot;/usr/caravel_project/caravel/&quot;</span>

  <span class="c1">#eg MCW_ROOT: &quot;/usr/Desktop/caravel_project/caravel_mgmt_soc_litex/&quot;</span>
  <span class="c1">#like repo https://github.com/efabless/caravel_mgmt_soc_litex</span>
  <span class="c1"># MCW_ROOT: &quot;/home/rady/caravel/swift/swift2&quot;</span>
  <span class="n">MCW_ROOT</span><span class="p">:</span> <span class="s2">&quot;/usr/caravel_project/caravel_mgmt_soc_litex/&quot;</span>

  <span class="c1">#eg USER_PROJECT_ROOT: &quot;/usr/Desktop/caravel_project/caravel_user_project/&quot;</span>
  <span class="c1">#like repo https://github.com/efabless/caravel_user_project</span>
  <span class="n">USER_PROJECT_ROOT</span><span class="p">:</span> <span class="s2">&quot;/usr/caravel_project/&quot;</span>

  <span class="c1">#eg PDK_ROOT: &quot;/usr/Desktop/caravel_project/pdk/&quot;</span>
  <span class="c1">#exported by volare</span>
  <span class="n">PDK_ROOT</span><span class="p">:</span> <span class="s2">&quot;/usr/pdk&quot;</span>

  <span class="c1">#eg PDK: &quot;sky130A&quot;</span>
  <span class="n">PDK</span><span class="p">:</span> <span class="n">sky130A</span>
  <span class="c1">#PDK: gf180mcuC</span>

  <span class="c1">#clock in ns</span>
  <span class="n">clk</span><span class="p">:</span> <span class="mi">25</span>

  <span class="c1"># true when caravan are simulated instead of Caravel</span>
  <span class="n">caravan</span><span class="p">:</span> <span class="n">false</span>

  <span class="c1"># optional email address to send the results to</span>
  <span class="n">emailto</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</pre></div>
</div>
<blockquote>
<div><p><strong>Note</strong>: This step is required only in the first run.</p>
</div></blockquote>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to caravel_cocotb’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="python_api.html" class="btn btn-neutral float-right" title="Python APIs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Efabless.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>